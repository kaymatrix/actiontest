name: SYNC_CMS_to_Security
on: [push, pull_request]
env:
  MY_TOKEN: "${{ secrets.MY_TOKEN }}"
jobs:
  SYNC_REPOS:
    runs-on: ubuntu-latest
    
    steps:
    - name: checkout_dst
      uses: actions/checkout@v2   
      with:
          repository: kaymatrix/actiontest2
          path: ./repodst
    - run: echo "Check out dst repo & initialize 1 sync..."
    - run: pwd
    - run: ls
    
    - name: checkout_src
      uses: actions/checkout@main   
      with:
          repository: kaymatrix/actiontest
          path: ./reposrc       
    - run: echo "Check out src repo & initialize 2 sync..."
    - run: pwd
    - run: ls
    - run: chmod 755 ./reposrc/scripts/syncrepo.sh
    - run: ./reposrc/scripts/syncrepo.sh      
    - run: git config --global user.name "kaymatrix"
    - run: git config --global user.email "kaymatrix@gmail.com"
    - run: git remote set-url origin "https://x-access-token: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@github.com/kaymatrix/actiontest2.git"
      working-directory: ./repodst
    - run: git add .
      working-directory: ./repodst
    - run: git commit -am "Automated report"
      working-directory: ./repodst    
    - run: git push
      working-directory: ./repodst
      
    
    - run: echo "End"
